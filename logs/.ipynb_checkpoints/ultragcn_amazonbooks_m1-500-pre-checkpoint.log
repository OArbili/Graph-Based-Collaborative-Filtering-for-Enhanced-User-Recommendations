###################### UltraGCN Plus Plus ######################
./configs/ultragcn_amazonbooks_m1-500-pre.ini
torch.cuda.is_available() True
cuda
load path = ./amazon_ii_constraint_mat object
load path = ./amazon_ii_neighbor_mat object
Load Configuration OK, show them below
Configuration:
{'embedding_dim': 64, 'ii_neighbor_num': 10, 'model_save_path': './ultragcn_amazon.pt', 'max_epoch': 2000, 'enable_tensorboard': True, 'initial_weight': 0.0001, 'dataset': 'amazon', 'gpu': '0', 'device': device(type='cuda'), 'lr': 0.001, 'batch_size': 1024, 'early_stop_epoch': 15, 'w1': 1e-08, 'w2': 1.0, 'w3': 1.0, 'w4': 1e-08, 'negative_num': 500, 'negative_weight': 500.0, 'gamma': 0.0001, 'lambda': 2.75, 'sampling_sift_pos': False, 'test_batch_size': 2048, 'topk': 20, 'user_num': 52643, 'item_num': 91599}
start load weight
torch.Size([52643, 64])
torch.Size([91599, 64])
end load weight
cuda
Total training batches = 2325
The time for epoch 0 is: train time = 00: 03: 16, test time = 00: 00: 37
Loss = 49.73312, F1-score: 0.010075 	 Precision: 0.00722	 Recall: 0.01667	NDCG: 0.01301
The time for epoch 5 is: train time = 00: 03: 14, test time = 00: 00: 39
Loss = 530.27771, F1-score: 0.020034 	 Precision: 0.01454	 Recall: 0.03222	NDCG: 0.02654
The time for epoch 10 is: train time = 00: 03: 14, test time = 00: 00: 38
Loss = 555.13635, F1-score: 0.027668 	 Precision: 0.01981	 Recall: 0.04587	NDCG: 0.03738
The time for epoch 15 is: train time = 00: 03: 15, test time = 00: 00: 39
Loss = 572.10828, F1-score: 0.032786 	 Precision: 0.02336	 Recall: 0.05498	NDCG: 0.04472
The time for epoch 20 is: train time = 00: 03: 13, test time = 00: 00: 38
Loss = 591.80200, F1-score: 0.036316 	 Precision: 0.02582	 Recall: 0.06119	NDCG: 0.04966
The time for epoch 25 is: train time = 00: 03: 14, test time = 00: 00: 38
Loss = 602.44092, F1-score: 0.038012 	 Precision: 0.02697	 Recall: 0.06438	NDCG: 0.05234
The time for epoch 30 is: train time = 00: 03: 13, test time = 00: 00: 37
Loss = 630.16711, F1-score: 0.039047 	 Precision: 0.02767	 Recall: 0.06633	NDCG: 0.05401
The time for epoch 35 is: train time = 00: 03: 10, test time = 00: 00: 37
Loss = 634.89490, F1-score: 0.039584 	 Precision: 0.02804	 Recall: 0.06729	NDCG: 0.05465
The time for epoch 40 is: train time = 00: 03: 13, test time = 00: 00: 39
Loss = 620.34344, F1-score: 0.039710 	 Precision: 0.02811	 Recall: 0.06760	NDCG: 0.05518
The time for epoch 45 is: train time = 00: 03: 13, test time = 00: 00: 38
Loss = 612.65552, F1-score: 0.039553 	 Precision: 0.02798	 Recall: 0.06746	NDCG: 0.05506
The time for epoch 50 is: train time = 00: 03: 11, test time = 00: 00: 41
Loss = 617.00470, F1-score: 0.039632 	 Precision: 0.02804	 Recall: 0.06758	NDCG: 0.05489
The time for epoch 51 is: train time = 00: 03: 13, test time = 00: 00: 35
Loss = 621.21680, F1-score: 0.039995 	 Precision: 0.02830	 Recall: 0.06815	NDCG: 0.05558
The time for epoch 52 is: train time = 00: 03: 11, test time = 00: 00: 34
Loss = 627.56952, F1-score: 0.040016 	 Precision: 0.02832	 Recall: 0.06817	NDCG: 0.05554
The time for epoch 53 is: train time = 00: 03: 11, test time = 00: 00: 35
Loss = 627.44678, F1-score: 0.039724 	 Precision: 0.02811	 Recall: 0.06768	NDCG: 0.05509
The time for epoch 54 is: train time = 00: 03: 13, test time = 00: 00: 33
Loss = 627.44421, F1-score: 0.040057 	 Precision: 0.02835	 Recall: 0.06825	NDCG: 0.05575
The time for epoch 55 is: train time = 00: 03: 10, test time = 00: 00: 34
Loss = 629.53052, F1-score: 0.039951 	 Precision: 0.02827	 Recall: 0.06810	NDCG: 0.05546
The time for epoch 56 is: train time = 00: 03: 11, test time = 00: 00: 35
Loss = 611.41040, F1-score: 0.039934 	 Precision: 0.02825	 Recall: 0.06807	NDCG: 0.05543
The time for epoch 57 is: train time = 00: 03: 10, test time = 00: 00: 35
Loss = 619.15735, F1-score: 0.039832 	 Precision: 0.02818	 Recall: 0.06792	NDCG: 0.05542
The time for epoch 58 is: train time = 00: 03: 10, test time = 00: 00: 34
Loss = 623.53369, F1-score: 0.039856 	 Precision: 0.02820	 Recall: 0.06795	NDCG: 0.05521
The time for epoch 59 is: train time = 00: 03: 11, test time = 00: 00: 33
Loss = 629.50635, F1-score: 0.039931 	 Precision: 0.02824	 Recall: 0.06815	NDCG: 0.05542
The time for epoch 60 is: train time = 00: 03: 11, test time = 00: 00: 34
Loss = 624.37805, F1-score: 0.040136 	 Precision: 0.02839	 Recall: 0.06845	NDCG: 0.05580
The time for epoch 61 is: train time = 00: 03: 13, test time = 00: 00: 33
Loss = 628.70911, F1-score: 0.040069 	 Precision: 0.02835	 Recall: 0.06831	NDCG: 0.05572
The time for epoch 62 is: train time = 00: 03: 12, test time = 00: 00: 34
Loss = 620.33191, F1-score: 0.040027 	 Precision: 0.02833	 Recall: 0.06819	NDCG: 0.05562
The time for epoch 63 is: train time = 00: 03: 10, test time = 00: 00: 33
Loss = 625.00732, F1-score: 0.039909 	 Precision: 0.02822	 Recall: 0.06815	NDCG: 0.05556
The time for epoch 64 is: train time = 00: 03: 12, test time = 00: 00: 34
Loss = 611.10468, F1-score: 0.039932 	 Precision: 0.02822	 Recall: 0.06825	NDCG: 0.05538
The time for epoch 65 is: train time = 00: 03: 11, test time = 00: 00: 34
Loss = 618.52753, F1-score: 0.039712 	 Precision: 0.02810	 Recall: 0.06768	NDCG: 0.05505
The time for epoch 66 is: train time = 00: 03: 11, test time = 00: 00: 34
Loss = 619.29926, F1-score: 0.040053 	 Precision: 0.02833	 Recall: 0.06831	NDCG: 0.05561
The time for epoch 67 is: train time = 00: 03: 11, test time = 00: 00: 34
Loss = 620.12231, F1-score: 0.039781 	 Precision: 0.02815	 Recall: 0.06779	NDCG: 0.05541
The time for epoch 68 is: train time = 00: 03: 10, test time = 00: 00: 34
Loss = 629.84882, F1-score: 0.040107 	 Precision: 0.02840	 Recall: 0.06826	NDCG: 0.05564
The time for epoch 69 is: train time = 00: 03: 12, test time = 00: 00: 34
Loss = 614.54907, F1-score: 0.039972 	 Precision: 0.02828	 Recall: 0.06813	NDCG: 0.05551
The time for epoch 70 is: train time = 00: 03: 11, test time = 00: 00: 34
Loss = 630.74609, F1-score: 0.039883 	 Precision: 0.02822	 Recall: 0.06796	NDCG: 0.05539
The time for epoch 71 is: train time = 00: 03: 10, test time = 00: 00: 35
Loss = 627.86072, F1-score: 0.040013 	 Precision: 0.02833	 Recall: 0.06811	NDCG: 0.05550
The time for epoch 72 is: train time = 00: 03: 11, test time = 00: 00: 34
Loss = 617.00146, F1-score: 0.040172 	 Precision: 0.02844	 Recall: 0.06837	NDCG: 0.05561
The time for epoch 73 is: train time = 00: 03: 12, test time = 00: 00: 34
Loss = 631.24866, F1-score: 0.040145 	 Precision: 0.02842	 Recall: 0.06834	NDCG: 0.05559
The time for epoch 74 is: train time = 00: 03: 11, test time = 00: 00: 35
Loss = 627.17755, F1-score: 0.040064 	 Precision: 0.02838	 Recall: 0.06811	NDCG: 0.05568
The time for epoch 75 is: train time = 00: 03: 10, test time = 00: 00: 34
Loss = 632.33881, F1-score: 0.040105 	 Precision: 0.02837	 Recall: 0.06839	NDCG: 0.05560
##########################################
Early stop is triggered at 75 epochs.
Results:
best epoch = 60, best recall = 0.068447337959793, best ndcg = 0.05580400305466117
The best model is saved at ./ultragcn_amazon.pt
Training end!
END
